{% extends 'base.html' %}

{% block title %}Admin Dashboard - Al Muslim Engineers{% endblock %}

{% block content %}
<section class="admin-section">
    <div class="admin-sidebar">
        <div class="sidebar-header">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo">
            <h3>Admin Portal</h3>
        </div>
        
        <nav class="sidebar-nav">
            <a href="{{ url_for('admin_dashboard') }}" class="sidebar-link active">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a>
            <a href="{{ url_for('admin_products') }}" class="sidebar-link">
                <i class="fas fa-box"></i> Products
            </a>
            <a href="{{ url_for('admin_applications') }}" class="sidebar-link">
                <i class="fas fa-file-alt"></i> Applications
            </a>
            <a href="{{ url_for('admin_orders') }}" class="sidebar-link">
                <i class="fas fa-shopping-bag"></i> Orders
            </a>
            <a href="{{ url_for('admin_maintenance') }}" class="sidebar-link">
                <i class="fas fa-tools"></i> Maintenance
            </a>
            <a href="{{ url_for('admin_gallery') }}" class="sidebar-link">
                <i class="fas fa-images"></i> Gallery
            </a>
            <a href="{{ url_for('admin_feedback') }}" class="sidebar-link">
                <i class="fas fa-comments"></i> Feedback
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <a href="{{ url_for('logout') }}" class="sidebar-link">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </div>
    </div>
    
    <div class="admin-main">
        <div class="admin-header">
            <h1><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>
            <div class="header-actions">
                <span class="admin-badge"><i class="fas fa-user-shield"></i> Administrator</span>
            </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon bg-blue">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ stats.users }}</span>
                    <span class="stat-label">Total Clients</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-green">
                    <i class="fas fa-box"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ stats.products }}</span>
                    <span class="stat-label">Products</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-purple">
                    <i class="fas fa-shopping-bag"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ stats.orders }}</span>
                    <span class="stat-label">Orders</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-orange">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ stats.pending_applications }}</span>
                    <span class="stat-label">Pending Apps</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-red">
                    <i class="fas fa-tools"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ stats.pending_maintenance }}</span>
                    <span class="stat-label">Pending Maint.</span>
                </div>
            </div>
        </div>
        
        <div class="admin-grid">
            <div class="admin-card">
                <div class="card-header">
                    <h3><i class="fas fa-file-alt"></i> Recent Applications</h3>
                    <a href="{{ url_for('admin_applications') }}" class="btn btn-sm btn-outline">View All</a>
                </div>
                
                {% if recent_applications %}
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Reference</th>
                                <th>Client</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for app in recent_applications %}
                            <tr>
                                <td>{{ app.reference_number }}</td>
                                <td>{{ app.user.full_name }}</td>
                                <td>{{ app.application_type|title }}</td>
                                <td>
                                    <span class="status-badge status-{{ app.status }}">
                                        {{ app.status|replace('_', ' ')|title }}
                                    </span>
                                </td>
                                <td>
                                    <a href="{{ url_for('admin_application_detail', app_id=app.id) }}" class="btn btn-sm btn-outline">
                                        <i class="fas fa-eye"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <p>No recent applications</p>
                </div>
                {% endif %}
            </div>
            
            <div class="admin-card">
                <div class="card-header">
                    <h3><i class="fas fa-shopping-bag"></i> Recent Orders</h3>
                    <a href="{{ url_for('admin_orders') }}" class="btn btn-sm btn-outline">View All</a>
                </div>
                
                {% if recent_orders %}
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Order #</th>
                                <th>Client</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in recent_orders %}
                            <tr>
                                <td>{{ order.order_number }}</td>
                                <td>{{ order.user.full_name }}</td>
                                <td>PKR {{ "{:,.0f}".format(order.total_amount) }}</td>
                                <td>
                                    <span class="status-badge status-{{ order.status }}">
                                        {{ order.status|title }}
                                    </span>
                                </td>
                                <td>
                                    <a href="{{ url_for('admin_order_detail', order_id=order.id) }}" class="btn btn-sm btn-outline">
                                        <i class="fas fa-eye"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <p>No recent orders</p>
                </div>
                {% endif %}
            </div>
        </div>
        
        <div class="quick-actions-grid">
            <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
            <div class="quick-actions">
                <a href="{{ url_for('admin_add_product') }}" class="action-card">
                    <i class="fas fa-plus-circle"></i>
                    <span>Add Product</span>
                </a>
                <a href="{{ url_for('admin_add_gallery') }}" class="action-card">
                    <i class="fas fa-images"></i>
                    <span>Add Gallery Project</span>
                </a>
                <a href="{{ url_for('admin_applications') }}" class="action-card">
                    <i class="fas fa-file-alt"></i>
                    <span>Review Applications</span>
                </a>
                <a href="{{ url_for('admin_maintenance') }}" class="action-card">
                    <i class="fas fa-tools"></i>
                    <span>Maintenance Requests</span>
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}
